!function(a,b){function c(c,d){return this.$target=a(c),this.opts=a.extend({},j,d),this.isOpen===b&&this.__init(),this}var d,e,f,g,h,i,j={loading:"Loading",error:"The image could not be loaded"};c.prototype.__init=function(){var b=this;this.$link=this.$target.find("a"),this.$image=this.$target.find("img"),this.$flyout=a('<div class="easyzoom-flyout" />'),this.$notice=a('<div class="easyzoom-notice" />').text(this.opts.loading),this._loadFlyout(this.$link.attr("href")),this.$target.on("mouseenter touchstart",function(a){a.originalEvent.touches&&1!==a.originalEvent.touches.length||(a.preventDefault(),b.show(a))}).on("mousemove touchmove",function(a){b.isOpen&&(a.preventDefault(),b._move(a))}).on("mouseleave touchend",function(){b.isOpen&&b.hide()})},c.prototype.show=function(a){var b,c,h,i;!this.$flyout.parent().length&&this.isReady&&(this.isOpen=!0,this.$flyout.appendTo(this.$target),b=this.$image.width(),c=this.$image.height(),h=this.$flyout.width(),i=this.$flyout.height(),d=this.$zoom.width()-h,e=this.$zoom.height()-i,f=d/b,g=e/c,this._move(a))},c.prototype.hide=function(){this.$flyout.parent().length&&(this.$flyout.detach(),this.isOpen=!1)},c.prototype._move=function(a){0===a.type.indexOf("touch")?(h=a.originalEvent.touches[0].pageX,i=a.originalEvent.touches[0].pageY):(h=a.pageX||h,i=a.pageY||i);var b=this.$image.offset(),c=h-b.left,j=i-b.top,k=c*f,l=j*g;k=k>d?d:k,l=l>e?e:l,k>0&&l>0&&this.$zoom.css({left:-k,top:-l})},c.prototype._loadFlyout=function(b){var c=this,d=new Image;this.isReady=!1,this.$target.addClass("is-loading").append(this.$notice),d.onerror=function(){c.$notice.text(c.opts.error),c.$target.removeClass("is-loading").addClass("is-error")},d.onload=function(){c.isReady=!0,c.$notice.detach(),c.$flyout.html(c.$zoom),c.$target.removeClass("is-loading").addClass("is-ready")},d.style.position="absolute",d.src=b,this.$zoom=a(d)},a.fn.easyZoom=function(b){return this.each(function(){a.data(this,"easyZoom")||a.data(this,"easyZoom",new c(this,b))})},"function"==typeof define&&define.amd?define(function(){return c}):"undefined"!=typeof module&&module.exports&&(module.exports=c)}(jQuery);